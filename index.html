<!DOCTYPE html>
<html>
<head>
    <title>10K Clash Royale update 10000</title>
    <style>
        body { margin: 0; overflow: hidden; background: #222; }
        canvas { display: block; }
        #bottomGif {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 250px;
            z-index: 10;
            pointer-events: none;
        }
    </style>
</head>
<body>

<img id="bottomGif" src="https://media.tenor.com/j_MxsHf3fXIAAAAM/clash-royale-clash-mini.gif">

<script type="importmap">
{
  "imports": {
    "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
    "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
  }
}
</script>

<script type="module">
import * as THREE from 'three';
import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
import { FontLoader } from 'three/addons/loaders/FontLoader.js';
import { TextGeometry } from 'three/addons/geometries/TextGeometry.js';

/* Scene */
const scene = new THREE.Scene();

/* Background */
const loader = new THREE.TextureLoader();
loader.load(
    "https://support.supercell.com/images/_sidebarPortrait/CR-hamburger-for-portrait.jpg?v=1762334933",
    tex => scene.background = tex
);

/* Camera */
const camera = new THREE.PerspectiveCamera(
    window.innerWidth < 600 ? 85 : 75,
    window.innerWidth / window.innerHeight,
    0.1,
    1000
);
camera.position.set(0, 8, 15);
camera.lookAt(0, 4, 0);

/* Renderer */
const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setPixelRatio(window.devicePixelRatio);
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

/* Controls */
const controls = new OrbitControls(camera, renderer.domElement);
controls.enableDamping = true;

/* Materials */
const blueMaterial = new THREE.MeshStandardMaterial({ color: 0x228BEE, roughness: 0.4, metalness: 0.3 });
const goldMaterial = new THREE.MeshStandardMaterial({ color: 0xFFD700, metalness: 1, roughness: 0.3 });

const cakeHeight = 3;
const cakeRadius = 3;

/* CAKE */
const cakeMesh = new THREE.Mesh(
    new THREE.CylinderGeometry(cakeRadius, cakeRadius, cakeHeight, 64),
    blueMaterial
);
cakeMesh.position.y = cakeHeight / 2;
scene.add(cakeMesh);

function createShellGeometry() {
    const group = new THREE.Group();

    // Main mound (front rounded part)
    const moundGeo = new THREE.SphereGeometry(0.32, 20, 20, 0, Math.PI);
    const mound = new THREE.Mesh(moundGeo, goldMaterial);
    mound.scale.set(1.35, 0.9, 1);
    mound.position.set(0, 0, 0);
    group.add(mound);

    // Ridged “tail” behind the mound
    const tailGeo = new THREE.CylinderGeometry(0.001, 0.25, 0.45, 8, 1);
    const tail = new THREE.Mesh(tailGeo, goldMaterial);
    tail.rotation.x = Math.PI / 2;
    tail.position.set(0, 0, -0.32);
    group.add(tail);

    return group;
}

    
/* Top Shell Border */
const topBorder = new THREE.Group();
scene.add(topBorder);

const count = 34;
for (let i = 0; i < count; i++) {
    const angle = (i / count) * Math.PI * 2;
    const x = Math.cos(angle) * cakeRadius * 0.92;
    const z = Math.sin(angle) * cakeRadius * 0.92;

    const s = createShellGeometry();
    s.position.set(x, cakeHeight + 0.1, z);

    // Make it face outward around the circle
    s.lookAt(0, cakeHeight + 0.1, 0);

    topBorder.add(s);
}


/* BOTTOM BORDER */
const bottomBorder = new THREE.Group();
scene.add(bottomBorder);

const bottomCount = 40;
for (let i = 0; i < bottomCount; i++) {
    const angle = (i / bottomCount) * Math.PI * 2;
    const x = Math.cos(angle) * cakeRadius * 0.96;
    const z = Math.sin(angle) * cakeRadius * 0.96;

    const s = createShellGeometry();
    s.scale.set(1.25, 1.25, 1.25); // slightly bigger for the base
    s.position.set(x, 0.12, z);
    s.lookAt(0, 0.12, 0);

    bottomBorder.add(s);
}


/* FLOATING TEXT */
const fontLoader = new FontLoader();
fontLoader.load(
    "https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",
    font => {
        const textGeo = new TextGeometry("CONGRATS ON 10,000!!!", {
            font: font,
            size: 0.8,
            height: 0.2
        });
        textGeo.center();
        const textMesh = new THREE.Mesh(textGeo, goldMaterial);
        textMesh.position.y = cakeHeight + 2.5;
        scene.add(textMesh);
    }
);

/* CONFETTI */
const confettiGroup = new THREE.Group();
scene.add(confettiGroup);

const confTexture = loader.load("https://event.supercell.com/clashroyale/images/landing/crown.png");

function createConfetti() {
    const geo = new THREE.PlaneGeometry(0.5, 0.5);
    const mat = new THREE.MeshBasicMaterial({ map: confTexture, transparent: true });

    const c = new THREE.Mesh(geo, mat);
    c.position.set((Math.random() - 0.5) * 10, Math.random() * 5 + 5, (Math.random() - 0.5) * 10);
    c.fallSpeed = Math.random() * 0.05 + 0.02;
    c.rotationSpeed = Math.random() * 0.05;
    confettiGroup.add(c);
}

for (let i = 0; i < 100; i++) createConfetti();

/* TOPPERS */
/* TOPPERS — Horizontal Line with Images */
const topperGroup = new THREE.Group();
scene.add(topperGroup);

const textureLoader = new THREE.TextureLoader();

// Put your 3 image URLs here:
const topperImageURLs = [
    "https://cdn-assets-eu.frontify.com/s3/frontify-enterprise-files-eu/eyJwYXRoIjoic3VwZXJjZWxsXC9maWxlXC9XWG8xNXVSR2JYNWV2dWE5QzltaC5wbmcifQ:supercell:tcrdoGKhtUxp2p_cD-6-kWmWLZ6abJ09QGu4hGhpb3k?width=2400",
    "https://cdn-assets-eu.frontify.com/s3/frontify-enterprise-files-eu/eyJwYXRoIjoic3VwZXJjZWxsXC9maWxlXC9LbUtDQndaMnZVbnRBc2g5Z1pHTi5wbmcifQ:supercell:F_AVdzyT_vkz49YKP2EkdHIwJ2bjDARldFFA8uLb14A?width=2400",
    "https://cdn-assets-eu.frontify.com/s3/frontify-enterprise-files-eu/eyJwYXRoIjoic3VwZXJjZWxsXC9maWxlXC9qRjYzOGlIbWJpS1FFM010dlV1dC5wbmcifQ:supercell:r4DzRtvyswMVOrHvTh6QiiFScO9sEMEGvYjOyyy0fGE?width=2400"
];

// Load textures
const topperTextures = topperImageURLs.map(url => textureLoader.load(url));

// spacing between toppers
const topperSpacing = 2.2;

// compute horizontal start
const startX = -(topperTextures.length - 1) * topperSpacing * 0.5;

topperTextures.forEach((tex, i) => {

    /* ---- Stick ---- */
    const stick = new THREE.Mesh(
        new THREE.CylinderGeometry(0.05, 0.05, 2),
        new THREE.MeshStandardMaterial({ color: 0x804000 })
    );
    stick.position.set(startX + i * topperSpacing, cakeHeight + 0.7, 0);

    /* ---- Topper Plane (image) ---- */
    const topperPlane = new THREE.Mesh(
        new THREE.PlaneGeometry(2, 2.2), // adjust size here
        new THREE.MeshStandardMaterial({
            map: tex,
            transparent: true
        })
    );

    topperPlane.position.set(startX + i * topperSpacing, cakeHeight + 2, 0);
    topperPlane.lookAt(camera.position);

    /* ---- Group ---- */
    const g = new THREE.Group();
    g.add(stick);
    g.add(topperPlane);

    topperGroup.add(g);
});


/* LIGHTS */
scene.add(new THREE.AmbientLight(0xffffff, 0.8));
const dl = new THREE.DirectionalLight(0xffffff, 1.5);
dl.position.set(5, 15, 10);
scene.add(dl);

/* ANIMATE */
function animate() {
    requestAnimationFrame(animate);

    confettiGroup.children.forEach(c => {
        c.position.y -= c.fallSpeed;
        c.rotation.x += c.rotationSpeed;
        c.rotation.y += c.rotationSpeed;
        if (c.position.y < -1) {
            c.position.y = Math.random() * 5 + 5;
        }
    });

    controls.update();
    renderer.render(scene, camera);
}
animate();

/* RESIZE */
window.addEventListener("resize", () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>

</body>
</html>
